import{_ as t,aW as e,s as o,Z as i,o as n,c as a,w as s,i as u,a as c,b as l,m as p,t as d,r,d as f,e as m,f as g,v as h}from"./index-886f4693.js";import{_}from"./uni-popup.2d91bf48.js";import{a as y}from"./util.5a26095b.js";import"./uni-transition.9cbbef98.js";var L=y;const S=t({data:()=>({title:"getLocation",hasLocation:!1,location:{},type:""}),methods:{togglePopup(t){this.type=t},showConfirm(){this.type="showpopup"},hideConfirm(){this.type=""},async getLocation(){this.doGetLocation()},doGetLocation(){e({success:t=>{this.hasLocation=!0,this.location=L(t.longitude,t.latitude)},fail:t=>{t.errMsg.indexOf("auth deny")>=0?o({title:"访问位置被拒绝"}):o({title:t.errMsg})}})},getSetting:function(){return new Promise(((t,e)=>{uni.getSetting({success:e=>{void 0!==e.authSetting["scope.userLocation"]?e.authSetting["scope.userLocation"]?t(1):t(2):t(0)}})}))},openSetting:function(){this.hideConfirm(),uni.openSetting({success:t=>{t.authSetting&&t.authSetting["scope.userLocation"]&&this.doGetLocation()},fail:t=>{}})},async checkPermission(){let t=permision.isIOS?await permision.requestIOS("location"):await permision.requestAndroid("android.permission.ACCESS_FINE_LOCATION");return null===t||1===t?t=1:2===t?i({content:"系统定位已关闭",confirmText:"确定",showCancel:!1,success:function(t){}}):t.code?i({content:t.message}):i({content:"需要定位权限",confirmText:"设置",success:function(t){t.confirm&&permision.gotoAppSetting()}}),t},clear:function(){this.hasLocation=!1}}},[["render",function(t,e,o,i,y,L){const S=r(m("page-head"),f),C=u,w=g,k=h,x=r(m("uni-popup"),_);return n(),a(C,null,{default:s((()=>[c(S,{title:y.title},null,8,["title"]),c(C,{class:"uni-padding-wrap"},{default:s((()=>[c(C,{style:{background:"#FFFFFF",padding:"40rpx"}},{default:s((()=>[c(C,{class:"uni-hello-text uni-center"},{default:s((()=>[l("当前位置经纬度")])),_:1}),!1===y.hasLocation?(n(),a(C,{key:0,class:"uni-h2 uni-center uni-common-mt"},{default:s((()=>[l("未获取")])),_:1})):p("",!0),!0===y.hasLocation?(n(),a(C,{key:1,class:"uni-h2 uni-center uni-common-mt"},{default:s((()=>[c(w,null,{default:s((()=>[l("E: "+d(y.location.longitude[0])+"°"+d(y.location.longitude[1])+"′",1)])),_:1}),c(w,null,{default:s((()=>[l("\\nN: "+d(y.location.latitude[0])+"°"+d(y.location.latitude[1])+"′",1)])),_:1})])),_:1})):p("",!0)])),_:1}),c(C,{class:"uni-btn-v"},{default:s((()=>[c(k,{type:"primary",onClick:L.getLocation},{default:s((()=>[l("获取位置")])),_:1},8,["onClick"]),c(k,{onClick:L.clear},{default:s((()=>[l("清空")])),_:1},8,["onClick"])])),_:1})])),_:1}),c(x,{show:"showpopup"===y.type,mode:"fixed",onHidePopup:e[1]||(e[1]=t=>L.togglePopup(""))},{default:s((()=>[c(C,{class:"popup-view"},{default:s((()=>[c(w,{class:"popup-title"},{default:s((()=>[l("需要用户授权位置权限")])),_:1}),c(C,{class:"uni-flex popup-buttons"},{default:s((()=>[c(k,{class:"uni-flex-item",type:"primary","open-type":"openSetting",onClick:L.openSetting},{default:s((()=>[l("设置")])),_:1},8,["onClick"]),c(k,{class:"uni-flex-item",onClick:e[0]||(e[0]=t=>L.togglePopup(""))},{default:s((()=>[l("取消")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])])),_:1})}],["__scopeId","data-v-d9df7ac7"]]);export{S as default};
