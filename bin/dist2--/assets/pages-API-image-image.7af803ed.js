import{_ as e,T as s,Z as a,a9 as l,o as t,c as i,w as n,i as u,a as c,b as o,t as d,z as r,A as p,F as f,r as g,d as h,e as _,N as m,H as y,g as I}from"./index-886f4693.js";import{p as T}from"./permission.af91603e.js";var x=[["camera"],["album"],["camera","album"]],C=[["compressed"],["original"],["compressed","original"]];const z=e({data:()=>({title:"choose/previewImage",imageList:[],sourceTypeIndex:2,sourceType:["拍照","相册","拍照或相册"],sizeTypeIndex:2,sizeType:["压缩","原图","压缩或原图"],countIndex:8,count:[1,2,3,4,5,6,7,8,9]}),onUnload(){this.imageList=[],this.sourceTypeIndex=2,this.sourceType=["拍照","相册","拍照或相册"],this.sizeTypeIndex=2,this.sizeType=["压缩","原图","压缩或原图"],this.countIndex=8},methods:{sourceTypeChange:function(e){this.sourceTypeIndex=parseInt(e.detail.value)},sizeTypeChange:function(e){this.sizeTypeIndex=parseInt(e.detail.value)},countChange:function(e){this.countIndex=e.detail.value},chooseImage:async function(){if(9===this.imageList.length){let e=await this.isFullImg();if(console.log("是否继续?",e),!e)return}s({sourceType:x[this.sourceTypeIndex],sizeType:C[this.sizeTypeIndex],count:this.imageList.length+this.count[this.countIndex]>9?9-this.imageList.length:this.count[this.countIndex],success:e=>{this.imageList=this.imageList.concat(e.tempFilePaths)},fail:e=>{console.log("err: ",e)}})},isFullImg:function(){return new Promise((e=>{a({content:"已经有9张图片了,是否清空现有图片？",success:s=>{s.confirm?(this.imageList=[],e(!0)):e(!1)},fail:()=>{e(!1)}})}))},previewImage:function(e){var s=e.target.dataset.src;l({current:s,urls:this.imageList})},async checkPermission(e){let s=e?e-1:this.sourceTypeIndex,l=T.isIOS?await T.requestIOS(x[s][0]):await T.requestAndroid(0===s?"android.permission.CAMERA":"android.permission.READ_EXTERNAL_STORAGE");return null===l||1===l?l=1:a({content:"没有开启权限",confirmText:"设置",success:function(e){e.confirm&&T.gotoAppSetting()}}),l}}},[["render",function(e,s,a,l,T,x){const C=g(_("page-head"),h),z=u,v=m,L=I,b=y;return t(),i(z,null,{default:n((()=>[c(C,{title:T.title},null,8,["title"]),c(z,{class:"uni-common-mt"},{default:n((()=>[c(b,null,{default:n((()=>[c(z,{class:"uni-list"},{default:n((()=>[c(z,{class:"uni-list-cell"},{default:n((()=>[c(z,{class:"uni-list-cell-left"},{default:n((()=>[c(z,{class:"uni-label"},{default:n((()=>[o("图片来源")])),_:1})])),_:1}),c(z,{class:"uni-list-cell-right"},{default:n((()=>[c(v,{range:T.sourceType,onChange:x.sourceTypeChange,value:T.sourceTypeIndex,mode:"selector"},{default:n((()=>[c(z,{class:"uni-input"},{default:n((()=>[o(d(T.sourceType[T.sourceTypeIndex]),1)])),_:1})])),_:1},8,["range","onChange","value"])])),_:1})])),_:1}),c(z,{class:"uni-list-cell"},{default:n((()=>[c(z,{class:"uni-list-cell-left"},{default:n((()=>[c(z,{class:"uni-label"},{default:n((()=>[o("图片质量")])),_:1})])),_:1}),c(z,{class:"uni-list-cell-right"},{default:n((()=>[c(v,{range:T.sizeType,onChange:x.sizeTypeChange,value:T.sizeTypeIndex,mode:"selector"},{default:n((()=>[c(z,{class:"uni-input"},{default:n((()=>[o(d(T.sizeType[T.sizeTypeIndex]),1)])),_:1})])),_:1},8,["range","onChange","value"])])),_:1})])),_:1}),c(z,{class:"uni-list-cell"},{default:n((()=>[c(z,{class:"uni-list-cell-left"},{default:n((()=>[c(z,{class:"uni-label"},{default:n((()=>[o("数量限制")])),_:1})])),_:1}),c(z,{class:"uni-list-cell-right"},{default:n((()=>[c(v,{range:T.count,onChange:x.countChange,mode:"selector"},{default:n((()=>[c(z,{class:"uni-input"},{default:n((()=>[o(d(T.count[T.countIndex]),1)])),_:1})])),_:1},8,["range","onChange"])])),_:1})])),_:1})])),_:1}),c(z,{class:"uni-list list-pd"},{default:n((()=>[c(z,{class:"uni-list-cell cell-pd"},{default:n((()=>[c(z,{class:"uni-uploader"},{default:n((()=>[c(z,{class:"uni-uploader-head"},{default:n((()=>[c(z,{class:"uni-uploader-title"},{default:n((()=>[o("点击可预览选好的图片")])),_:1}),c(z,{class:"uni-uploader-info"},{default:n((()=>[o(d(T.imageList.length)+"/9",1)])),_:1})])),_:1}),c(z,{class:"uni-uploader-body"},{default:n((()=>[c(z,{class:"uni-uploader__files"},{default:n((()=>[(t(!0),r(f,null,p(T.imageList,((e,s)=>(t(),i(z,{key:s,class:"uni-uploader__file"},{default:n((()=>[c(L,{class:"uni-uploader__img",src:e,"data-src":e,onClick:x.previewImage},null,8,["src","data-src","onClick"])])),_:2},1024)))),128)),c(z,{class:"uni-uploader__input-box"},{default:n((()=>[c(z,{class:"uni-uploader__input",onClick:x.chooseImage},null,8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-bd82ad51"]]);export{z as default};
