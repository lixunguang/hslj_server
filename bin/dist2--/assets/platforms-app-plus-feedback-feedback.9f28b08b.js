import{_ as e,a8 as s,T as a,a9 as t,Z as l,aa as n,ab as i,ac as o,o as c,c as d,w as u,ad as r,i as f,a as p,b as m,t as _,z as h,A as g,F as b,ae as k,af as C,f as v,Q as D,I as L,r as w,e as I,v as y,g as V}from"./index-886f4693.js";import{_ as x}from"./uni-rate.5a445b54.js";import"./uni-icons.072c6819.js";const j=e({data:()=>({msgContents:["界面显示错乱","启动缓慢，卡出翔了","UI无法直视，丑哭了","偶发性崩溃"],stars:[1,2,3,4,5],imageList:[],sendDate:{score:0,content:"",contact:""}}),onLoad(){this.deviceInfo={appid:"__UNI__5D0B0CA",imei:plus.device.imei,p:"Android"===plus.os.name?"a":"i",md:plus.device.model,app_version:plus.runtime.version,plus_version:plus.runtime.innerVersion,os:plus.os.version,net:""+plus.networkinfo.getCurrentType()},this.sendDate=Object.assign(this.deviceInfo,this.sendDate)},methods:{close(e){this.imageList.splice(e,1)},chooseMsg(){s({itemList:this.msgContents,success:e=>{this.sendDate.content=this.msgContents[e.tapIndex]}})},chooseImg(){a({sourceType:["camera","album"],sizeType:"compressed",count:5-this.imageList.length,success:e=>{this.imageList=this.imageList.concat(e.tempFilePaths)}})},chooseStar(e){this.sendDate.score=e},previewImage(e){t({urls:this.imageList,current:this.imageList[e]})},send(){if(0===this.sendDate.content.length)return void l({content:"请输入问题和意见",showCancel:!1});n({title:"上传中..."});let e=this.imageList.map(((e,s)=>({name:"images"+s,uri:e})));this.request(this.sendDate,e).then((e=>{"string"==typeof e.data&&(e.data=JSON.parse(e.data)),200===e.statusCode&&e.data&&0===e.data.ret?(l({content:"反馈成功",showCancel:!1}),this.imageList=[],this.sendDate=Object.assign(this.deviceInfo,{score:0,content:"",contact:""})):200!==e.statusCode?l({content:"反馈失败，错误码为："+e.statusCode,showCancel:!1}):l({content:"反馈失败",showCancel:!1})})).catch((e=>{console.log(e)}))},request:(e,s)=>new Promise(((a,t)=>{let l={url:"https://service.dcloud.net.cn/feedback",success:e=>{a(e)},fail:e=>{t(e)},complete(){r()}};s.length>0?(l.files=s,l.formData=e,i(l)):(l.data=e,l.method="POST",o(l))}))}},[["render",function(e,s,a,t,l,n){const i=v,o=f,r=D,j=V,T=L,U=w(I("uni-rate"),x),O=y;return c(),d(o,{class:"page"},{default:u((()=>[p(o,{class:"feedback-title"},{default:u((()=>[p(i,null,{default:u((()=>[m("问题和意见")])),_:1}),p(i,{class:"feedback-quick",onClick:n.chooseMsg},{default:u((()=>[m("快速键入")])),_:1},8,["onClick"])])),_:1}),p(o,{class:"feedback-body"},{default:u((()=>[p(r,{placeholder:"请详细描述你的问题和意见...",modelValue:l.sendDate.content,"onUpdate:modelValue":s[0]||(s[0]=e=>l.sendDate.content=e),class:"feedback-textare"},null,8,["modelValue"])])),_:1}),p(o,{class:"feedback-title"},{default:u((()=>[p(i,null,{default:u((()=>[m("图片(选填,提供问题截图,总大小10M以下)")])),_:1})])),_:1}),p(o,{class:"feedback-body feedback-uploader"},{default:u((()=>[p(o,{class:"uni-uploader"},{default:u((()=>[p(o,{class:"uni-uploader-head"},{default:u((()=>[p(o,{class:"uni-uploader-title"},{default:u((()=>[m("点击预览图片")])),_:1}),p(o,{class:"uni-uploader-info"},{default:u((()=>[m(_(l.imageList.length)+"/5",1)])),_:1})])),_:1}),p(o,{class:"uni-uploader-body"},{default:u((()=>[p(o,{class:"uni-uploader__files"},{default:u((()=>[(c(!0),h(b,null,g(l.imageList,((e,s)=>(c(),d(o,{key:s,class:"uni-uploader__file",style:{position:"relative"}},{default:u((()=>[p(j,{class:"uni-uploader__img",src:e,onClick:e=>n.previewImage(s)},null,8,["src","onClick"]),p(o,{class:"close-view",onClick:e=>n.close(s)},{default:u((()=>[m("x")])),_:2},1032,["onClick"])])),_:2},1024)))),128)),k(p(o,{class:"uni-uploader__input-box"},{default:u((()=>[p(o,{class:"uni-uploader__input",onClick:n.chooseImg},null,8,["onClick"])])),_:1},512),[[C,l.imageList.length<5]])])),_:1})])),_:1})])),_:1})])),_:1}),p(o,{class:"feedback-title"},{default:u((()=>[p(i,null,{default:u((()=>[m("QQ/邮箱")])),_:1})])),_:1}),p(o,{class:"feedback-body"},{default:u((()=>[p(T,{class:"feedback-input",modelValue:l.sendDate.contact,"onUpdate:modelValue":s[1]||(s[1]=e=>l.sendDate.contact=e),placeholder:"(选填,方便我们联系你 )"},null,8,["modelValue"])])),_:1}),p(o,{class:"feedback-title feedback-star-view"},{default:u((()=>[p(i,null,{default:u((()=>[m("应用评分")])),_:1}),p(o,{class:"feedback-star-view"},{default:u((()=>[p(U,{modelValue:l.sendDate.score,"onUpdate:modelValue":s[2]||(s[2]=e=>l.sendDate.score=e),color:"#bbb"},null,8,["modelValue"])])),_:1})])),_:1}),p(O,{type:"default",class:"feedback-submit",onClick:n.send},{default:u((()=>[m("提交")])),_:1},8,["onClick"]),p(o,{class:"feedback-title"},{default:u((()=>[p(i,null,{default:u((()=>[m("用户反馈的结果可在app打包后于DCloud开发者中心查看")])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-bd3a2b21"]]);export{j as default};
