import{_ as t,D as e,af as a,v as s,f as i,A as l,g as n,o as r,c as d,w as o,d as h,t as c,b as u,a as m,z as p,e as f,F as b,r as y,am as _,i as g}from"./index-eb11052f.js";import{_ as C}from"./uni-tooltip.bce57969.js";const T=t({name:"uni-stat-tabs",data:()=>({currentTab:0,renderTabs:[],cacheKey:"uni-admin-statTabsData"}),props:{type:{type:String,default:"line"},value:{type:[String,Number],default:""},modelValue:{type:[String,Number],default:""},current:{type:[String,Number],default:0},mode:{type:String,default:""},today:{type:Boolean,default:!1},yesterday:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},tooltip:{type:Boolean,default:!1},all:{type:Boolean,default:!0},label:{type:String,default:""},placeholder:{type:String,default:"暂无选项"},tabs:{type:Array,default:()=>[]}},created(){this.last=`${this.mode.replace("-","_")}_last_data`},mounted(){this.init()},computed:{},watch:{current:{immediate:!0,handler(t){this.currentTab=t}},tabs:{immediate:!1,handler(t){this.init()}},renderTabs(t){const e=this.current;this.mode&&t.length&&e>=0&&this.$nextTick((function(){const t=this.renderTabs[e];this.change(t,e)}))}},methods:{init(){if(this.mode.indexOf("platform")>-1)this.renderTabs=this.getCache()||[],this.getPlatform();else if("date"===this.mode){const t=[{_id:7,name:"最近七天"},{_id:30,name:"最近30天"},{_id:90,name:"最近90天"}];this.yesterday&&t.unshift({_id:1,name:"昨天"}),this.today&&t.unshift({_id:0,name:"今天"}),this.renderTabs=t}else this.renderTabs=this.tabs},change(t,e){if(t.disabled)return;const a=t._id,s=t.name;this.currentTab=e,this.emit(a,e,s,t)},emit(t,e,a,s){this.$emit("change",t,e,a,s),this.$emit("input",t,e,a),this.$emit("update:modelValue",t,e,a)},getPlatform(){e.database().collection("uni-stat-app-platforms").get().then((t=>{let e=t.result.data;if(e=e.filter((t=>!t.hasOwnProperty("enable")||t.enable)),e.sort(((t,e)=>t.order-e.order)),"platform-channel"===this.mode){e=e.filter((t=>/^android|ios$/.test(t.code)));let t=e.map((t=>`platform_id == "${t._id}"`)).join(" || ");t=`(${t})`,this.setAllItem(e,t)}else if("platform-scene"===this.mode){e=e.filter((t=>/mp-/.test(t.code)));let t=e.map((t=>`platform_id == "${t._id}"`)).join(" || ");t=`(${t})`,this.setAllItem(e,t)}else this.setAllItem(e);this.setCache(e),this.renderTabs=e}))},setAllItem(t,e="",a="全部"){this.all&&t.unshift({name:a,_id:e})},getCurrentCacheKey(){return this.mode},getCache(t=this.getCurrentCacheKey()){return(a(this.cacheKey)||{})[t]},setCache(t,e=this.getCurrentCacheKey()){let i=a(this.cacheKey)||{};i[e]=t,s(this.cacheKey,i)},removeCache(t=this.getCurrentCacheKey()){let e=a(this.cacheKey)||{};delete e[t],s(this.cacheKey,e)}}},[["render",function(t,e,a,s,T,$){const K=g,k=i(n("uni-icons"),l),S=i(n("uni-tooltip"),C);return r(),d(K,{class:"uni-stat--tab-x"},{default:o((()=>[a.label?(r(),d(K,{key:0,class:"uni-label-text hide-on-phone"},{default:o((()=>[h(c(a.label+"："),1)])),_:1})):u("",!0),m(K,{class:"uni-stat--tab"},{default:o((()=>[T.renderTabs.length?(r(!0),f(b,{key:1},y(T.renderTabs,((t,e)=>(r(),d(K,{key:e,onClick:a=>$.change(t,e),class:p(["uni-stat--tab-item",[e===T.currentTab?`uni-stat--tab-item-${a.type}-active`:"",`uni-stat--tab-item-${a.type}`,t.disabled?"uni-stat--tab-item-disabled":""]])},{default:o((()=>[m(S,null,_({default:o((()=>[h(c(t.name)+" ",1),t.tooltip?(r(),d(k,{key:0,type:"help",color:"#666"})):u("",!0)])),_:2},[t.tooltip?{name:"content",fn:o((()=>[m(K,{class:"uni-stat-tooltip-s"},{default:o((()=>[h(c(t.tooltip),1)])),_:2},1024)])),key:"0"}:void 0]),1024)])),_:2},1032,["onClick","class"])))),128)):(r(),d(K,{key:0,class:p(["uni-stat--tab-item uni-stat--tab-item-disabled",[`uni-stat--tab-item-${a.type}`]])},{default:o((()=>[h(c(a.placeholder),1)])),_:1},8,["class"]))])),_:1})])),_:1})}],["__scopeId","data-v-317b24ae"]]);export{T as _};
